"use strict";!function(){function Bone(e){function n(){for(var e='<ul class="tabs-list">',n="",a=0,s=c.length,r=null;s>a;a++)r=c[a],e+='<li class="tab-item tab-'+r.id+'"><span>'+r.title+"</span></li>",n+='<div class="panel-item panel-'+r.id+'"></div>';e+="</ul>",p=p.replace("{{tabs}}",e).replace("{{panels}}",n),u.id="mobile-console-wrapper",u.innerHTML=p,document.body.appendChild(u),d=u.querySelectorAll(".tab-item"),u.querySelector(".mc-clear").addEventListener("click",t),u.querySelector(".mc-close").addEventListener("click",o),Array.prototype.map.call(d,function(e){e.addEventListener("click",function(){l(c[Array.prototype.indexOf.call(u.querySelectorAll(".tab-item"),this)].id)})}),i(),c.map(function(e){e.isReady=!0,e.initFn(u.querySelector(".tab-"+e.id),u.querySelector(".panel-"+e.id),e)}),l(c[0].id)}function l(e){for(var n=0,l=c.length;l>n;n++)if(c[n].id===e){r=c[n];break}Array.prototype.map.call(u.querySelectorAll(".tab-item"),function(e){e.className=e.className.replace(/(\s*|^)current(\s*|$)/g," ")}),u.querySelector(".tab-"+r.id).className+=" current",Array.prototype.map.call(u.querySelectorAll(".panel-item"),function(e){e.className=e.className.replace(/(\s*|^)current(\s*|$)/g," ")}),u.querySelector(".panel-"+r.id).className+=" current"}function t(){r&&r.clear?r.clear(u.querySelector(".panel-item.current")):u.querySelector(".panel-item.current").innerHTML=""}function o(){u.className+=" close"}function a(){u.className=u.className.replace(/(\s*|^)close(\s*|$)/g," ")}function s(e){e.length?c=c.concat(e):c.push(e),n()}function i(){var e=0;setTimeout(function(){Array.prototype.map.call(u.querySelectorAll(".tab-item"),function(n){e+=n.clientWidth+1}),u.querySelector(".tabs-list").style.width=e+"px"},0)}var c=[],r=null,u=document.createElement("div"),d=null,p='<div class="mc-tabs">{{tabs}}</div>          <div class="mc-panels">{{panels}}</div>          <div class="mc-bottom"><ul class="bottom-list"><div class="mc-clear bottom-item">清除</div><div class="mc-close bottom-item">关闭</div></ul></div>';s(e),this.open=a,this.close=o,this.getActivePanel=function(){return r||c[0]}}function Panel(e,n,l,t){if(this.id=e,this.title=n,this.initFn=l,t){var o="";for(o in t)this[o]=t[o]}}function _customizeInit(e){var n=[],l=null;e=e||[],e.map(function(e){n.push(new Panel(e.id,e.title,e.initFn,e.extend))}),l=new Bone(n),mobileConsole.bone=l,delete mobileConsole.customizeInit,delete mobileConsole.init}function _addPanel(e){customizePanels="[object Array]"===Object.prototype.toString.call(e)?e:[]}function _init(){var e=[],n=null,l=null,t=_createDefaultPanels();l=t.concat(customizePanels),l.map(function(n){e.push(new Panel(n.id,n.title,n.initFn,n.extend))}),n=new Bone(e),mobileConsole.bone=n,delete mobileConsole.init}function _createDefaultPanels(){var panels=[];return panels.push(_initConsolePanel()),panels.push(_initResourcePanel()),panels.push({id:"dom",title:"显示 HTML 结构",initFn:function(e,n){function l(){function e(n,l){var t="",o=[];return n.children.length>0&&Array.prototype.map.call(n.children,function(n){o.push(e(n,t))}),t=o.join(""),l+='<li class="dom-item"><span class="tag-name">'+n.tagName.toLowerCase()+'</span><span class="id">'+n.id+'</span><span class="class-name">'+n.className.split(/\s{1,}/g).join(".")+"</span>"+(t?'<ul class="children-item">'+t+"</ul>":"")+"</li>"}var l=e(document.documentElement,[]);n.querySelector(".html-content").innerHTML='<ul class="dom-list">'+l+"</ul>"}n.innerHTML='<div class="html-content"></div><div class="refresh">刷新</div>',n.querySelector(".html-content").addEventListener("click",function(e){var n=e.target.parentElement,l=n.className;l.indexOf("dom-item")>-1&&(l.indexOf("show")>-1?n.className=l.replace(/(\s*|^)show(\s*|$)/g," "):n.className+=" show")}),n.querySelector(".refresh").addEventListener("click",l),l()},extend:{clear:function(){}}}),panels.push({id:"script",title:"执行脚本",initFn:function(tab,panel){function run(){if(""!==ipt.value){try{console.log(ipt.value),console.log("> "+eval(ipt.value))}catch(e){console.error(e)}ipt.value=""}}var currentStatement="";panel.innerHTML='<div class="html-content"><textarea class="eval-textarea"></textarea></div><div class="run">执行</div>';var ipt=panel.querySelector(".eval-textarea");panel.querySelector(".run").addEventListener("click",run)},extend:{clear:function(e){e.querySelector(".eval-textarea").value=""}}}),panels}function _initConsolePanel(){function e(e){window.console={console:window.console},["log","error","warn","debug","info"].forEach(function(l){window.console[l]=function(){var t=e.innerHTML+n(arguments,l);e.innerHTML=t,window.console.console[l].apply(window.console.console,Array.prototype.slice.call(arguments))}})}function n(e,n){var l='<div class="'+n+' console-log">',t=0,o=e.length,a="";for(t;o>t;t++)a=e[t],l+='<span class="'+typeof a+'">'+a+"</span>";return l+="</div>"}function l(){window.addEventListener("error",function(e,n,l,t,o){console.error("Error: "+e+" Script: "+n+" Line: "+l+" Column: "+t+" StackTrace: "+o)})}return{id:"console",title:"控制台",initFn:function(n,t){e(t),l()}}}function _initResourcePanel(){function e(e){function n(n){Array.prototype.map.call(e.querySelectorAll(".resource-tab"),function(e){e.className=e.className.replace(/(\s*|^)current(\s*|$)/g," ")}),e.querySelector(".tab-"+n.toLowerCase()).className+=" current",Array.prototype.map.call(e.querySelectorAll(".resource-panel"),function(e){e.className=e.className.replace(/(\s*|^)current(\s*|$)/g," ")}),e.querySelector("."+n.toLowerCase()+"-panel").className+=" current",l=n}var o='<div class="resource-boxes">          <div class="resource-tabs">            <div class="resource-tab tab-cookie">Cookie</div>            <div class="resource-tab tab-localstorage">Local Storage</div>            <div class="resource-tab tab-sessionstorage">Session Storage</div>          </div>          <div class="resource-panels">            <div class="cookie-panel resource-panel">{{cookie}}</div>            <div class="localstorage-panel resource-panel">{{localStorage}}</div>            <div class="sessionstorage-panel resource-panel">{{sessionStorage}}</div>          </div>        </div>',a="",s="",i="",c="";document.cookie.split(/\s*;\s*/).forEach(function(e){""!==e&&(e=e.split(/\s*=\s*/),t.push(e[0]),a+='<li class="item"><span class="key">'+e[0]+'</span><span class="value">'+(e[1]||"")+"</span></li>")});for(c in window.localStorage)s+='<li class="item"><span class="key">'+c+'</span><span class="value">'+window.localStorage[c]+"</span></li>";for(c in window.sessionStorage)i+='<li class="item"><span class="key">'+c+'</span><span class="value">'+window.sessionStorage[c]+"</span></li>";e.innerHTML=o.replace("{{cookie}}",'<ul class="list">'+a+"</ul>").replace("{{localStorage}}",'<ul class="list">'+s+"</ul>").replace("{{sessionStorage}}",'<ul class="list">'+i+"</ul>"),n("cookie"),e.querySelector(".tab-cookie").addEventListener("click",function(){n("cookie")}),e.querySelector(".tab-localstorage").addEventListener("click",function(){n("localStorage")}),e.querySelector(".tab-sessionstorage").addEventListener("click",function(){n("sessionStorage")})}function n(e){window.confirm("确定清除全部 "+l+" 吗？")&&o[l](e)}var l=null,t=[],o={cookie:function(e){t.map(function(e){document.cookie=e+"=; expires=-1"}),t=[],e.querySelector(".cookie-panel").innerHTML=""},localStorage:function(e){window.localStorage.clear(),e.querySelector(".localstorage-panel").innerHTML=""},sessionStorage:function(e){window.sessionStorage.clear(),e.querySelector(".sessionstorage-panel").innerHTML=""}};return{id:"resource",title:"资源",initFn:function(n,l){e(l)},extend:{clear:n}}}var customizePanels=[],mobileConsole={init:_init,addPanel:_addPanel};"function"==typeof define&&define.amd?define([],function(){return mobileConsole}):"undefined"!=typeof module&&module.exports?module.exports=mobileConsole:window.mobileConsole=mobileConsole}();
